<div class="container-fluid"  ng-controller="game-Ctrl">
  <h2 ng-if="!president.isPresident">Trump Inc</h2>
  <h2 ng-if="president.isPresident">Royal Trump Incorporated</h2>

  <timer autostart="false" countdown="10" interval="1000" finish-callback="update()">Time until next day: {{countdown}}</timer>
  <label>Game Speed: {{settings.speed}}s per day</label><input type="range" min="1" max="10" ng-model="settings.speed"></input>
  <!--START INFO ROW-->
  <div class="row no-gutters">
    
    <div class="col-md-3">
      <h4>Start/Stop Game</h4>
      <button ng-if="settings.play" class="play btn btn-danger" ng-click="pause()">Pause</button>
      <button ng-if="!settings.play" class="play btn btn-success" ng-click="play()">Play</button>
    </div>
    <div class="col-md-3">
      <h4>Economy Information </h4>
      <div class="well">
        Supply : {{supply1}}, {{supply2}}</br>
        Demand : {{demand1}}, {{demand2}}</br>
        Average Quality: {{qualityAverage/100 | percentage:2}}<br><br><!--HUEHUEHUE-->
        Competitors made: {{competitorsMade1}},{{competitorsMade2}}
      </div>
    </div>

    <div class="col-md-3">
      <h4>Market History</h4>
      <div class="well" id="graph"></div> 
    </div>
    <div class="col-md-3">
      <h4>Finances</h4>
      <div class="well">
        <h5>Funds: {{ money | currency }}</h5></br>
        Allocated Budget: {{getBudgetUsed()|currency}}</br>
        <div ng-if="profit >= 0" class="green">Profit: {{profit|currency}}</div>
        <div ng-if="profit < 0" class="red">Loss: {{profit|currency}}</div>
        <img src="res/img/button-1.png" alt="b"> Button 1 stock: {{ button1stock }}</br>
        <img src="res/img/button-2.png" alt="b"> Button 2 stock: {{ button2stock }}</br>
      </div>
    </div>
  </div>
  <div class="row no-gutters">
    <div class="col-md-3">
      <div class="prod">
        <h4>Production Controls</h4>
        <div class="well">
          <label for="quality">Production Quality: {{production.quality}}%</label>
          <input type="range" class="slider" min="1" max="100" name="quality" 
                                                               ng-model="production.quality">
          <label for="quantity1"><img src="res/img/button-1.png" alt="b"> Button 1 Production count: {{production.quantity1}} (max {{getMaxProd1()}})</label>
          <input type="range" class="slider" min="0" max={{getMaxProd1()}} ng-change="updateQuantity()" ng-model="production.quantity1">

          <label for="quantity1"><img src="res/img/button-2.png" alt="b"> Button 2 Production count: {{production.quantity2}} (max {{getMaxProd2()}})</label>
          <input type="range" class="slider" min="0" max={{getMaxProd2()}} ng-change="updateQuantity()" ng-model="production.quantity2"></input>

          <label for="quantity1">Daily <img src="res/img/button-1.png" alt="b"> Button1 Shipping: {{retail.quantity1}} (max {{production.quantity1}})</label>
          <input type="range" class="slider" min="0" max={{production.quantity1}} ng-model ="retail.quantity1"></input>

          <label for="quantity2">Daily <img src="res/img/button-2.png" alt="b"> Button2 Shipping: {{retail.quantity2}} (max {{production.quantity2}})</label>
          <input type="range" class="slider" min="0" max={{production.quantity2}} ng-model ="retail.quantity2"></input>
          <div ng-if="presidencyRun">
            <label>Presidency Funding: {{funding.president|currency}}</label>
            <input type="range" class="slider" min="0" max={{money}} ng-model="funding.president"></input>
          </div>
        </div>
      </div>

    </div>
    <div class="col-md-3">
      <h4>Surplus controls</h4>
      <div class="well">
        <button ng-click="buyButton1()" class="btn">Buy <img src="res/img/button-1.png" alt="b"> Button 1 ({{priceArray1[dayMax]|currency}})</button><br>
        <br><button ng-click="buyButton2()" class="btn">Buy <img src="res/img/button-2.png" alt="b"> Button 2 ({{priceArray2[dayMax]|currency}})</button><br>
        <br><button ng-click="sellButton1()" class="btn">Sell <img src="res/img/button-1.png" alt="b"> Button 1 ({{priceArray1[dayMax]*multiplier|currency}})</button><br>
        <br><button ng-click="sellButton2()" class="btn">Sell <img src="res/img/button-2.png" alt="b"> Button 2 ({{priceArray2[dayMax]*multiplier|currency}})</button><br>        
      </div>
    </div>
    <div class="col-md-3">
      <h4>Donald Controls</h4>
      <div class="well">
        <p ng-if="qualityAverage < 60">Increase average quality<br> to 60% to run for president!</p>
        <button ng-if="!president.isPresident && !presidencyRun && allowPresidencyRun" ng-click="runForPresident()" class="btn">Run for president!</button>

        <div ng-if="presidencyRun">
          <!-- Anything presidency related -->
          <h4> Days left: {{president.timeleft}}</h4>
          <p> Approval Rating: {{president.approval}} (need {{president.required}})</p>
          <p> Approval Change per month: {{funding.president / 50000 | percentage:2}}</p>
          <button class="btn" ng-click="holdRally()">Hold Rally! (+10 approval, cost: {{getRallyCost()|currency}})</button>
        </div>

        <div ng-if="!presidencyRun">
          <!-- Anything non-president related-->
        </div>
      </div>

      <h4>Presidential Actions</h4>
      <div class="well" ng-if="!president.isPresident">
        <h4>Become president first!</h4>
      </div>
      <div ng-if="president.isPresident">
        <div class="well">
          <button ng-if="money >= 5000 &&!wallBuilt && qualityAverage > 75" class="btn" ng-click="buildTheWall()">
            Build the great mexican wall ($5000)
          </button>
          <p ng-if="!wallBuilt && (money < 5000 || qualityAverage <= 75)">[Required: $5000 and 75% average quality]</p>
          <button class="btn" ng-if="!internetClosed && money > 7500 && qualityAverage > 70" ng-click="closeInternet()">
            Close up the internet ($7500)
          </button> 
          <p ng-if="!internetClosed && (money <= 7500 || qualityAverage <= 70)">[Required: $7500 and 70% average quality]</p>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <h4>Dear Leader</h4>
      <img src="res/img/trump.png" alt="TRUMP" ng-if="!president.isPresident && !presidencyRun">
      <img src="res/img/trump-candid.png" alt="Trump is a candidate" ng-if="!president.isPresident && presidencyRun"> 
      <img src="res/img/god-king-trump.png" alt="god king" ng-if="president.isPresident">
    </div>
  </div>

</div>
<script type="text/javascript-lazy">
var dom_el = document.querySelector('[ng-controller="game-Ctrl"]');
var ng_el = angular.element(dom_el);
var scope = ng_el.scope();
//Set initial data
var seed = 50;
var priceArray = [scope.button1cost];
var priceArray2 = [scope.button2cost];
var karr = [];
for (i = 0; i < scope.dayMax; i++) {
  priceArray.push(Math.round(100*(priceArray[i] + 5*Math.random()*(Math.random()<0.5?-1:1)))/100);
  priceArray2.push(Math.round(100*(priceArray2[i] + 5*Math.random()*(Math.random()<0.5?-1:1)))/100);
  karr.push(i+1);
}
var c = function() {
  scope.priceArray1 = priceArray;
  scope.priceArray2 = priceArray2;
};
var phase = scope.$$phase;
if(phase == '$apply' || phase == '$digest') {
  if(c) {  
    c(); 
  }
} else {
  scope.$apply(c);
} 

var data = {x: karr, y: priceArray, name: "Button-1", type: 'scatter'};       
var data2 = {x: karr, y: priceArray2, name: "Button 2",  type: 'scatter'};
var layout = {title: "Button Market", width: 300, height: 200, autosize: false, yaxis: { title: "Price ($)" }, 
  xaxis: {title: "Days"}, margin: {l: 40, b: 30, t: 30, r:30}};
Plotly.newPlot("graph", [data, data2], layout);
</script>
  </div>
  </div>

  <!--
    <div class="col-md-3">
    <img class="trump" ng-if="!presidencyRun && !president.isPresident" src="res/img/trump-head.png" alt="TRUMP HEAD">
    <img class="trump" ng-if="presidencyRun" src="res/img/trump-presidency.png" alt="TRUMP HEAD">
    <img class="trump" ng-if="president.isPresident" src="res/img/god-king-trump.png" alt="GOD KING">
    </div>


    <div class="col-md-3">
    <img ng-if="!president.isPresident" class="trump" src="res/img/trump-stump.png" alt="TRUMP STUMP">
    <img ng-if="president.isPresident" class="trump" src="res/img/trump-pres-stump.png" alt="TRUMP STUMP">  
    </div>


    <div class="col-md-3">
    <img ng-if="!president.isPresident" class="trump" src="res/img/trump-body.png" alt="TRUMP BODY">
    <img ng-if="president.isPresident" class="trump" src="res/img/trump-pres-body.png" alt="TRUMP BODY">
    </div>
  -->
